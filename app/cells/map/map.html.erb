<%= javascript_include_tag "extend/map" %>
<%= javascript_include_tag  'http://api.map.baidu.com/api?v=1.2' %>
<%= javascript_include_tag  'http://api.map.baidu.com/library/TextIconOverlay/1.2/src/TextIconOverlay.js' %>
<%= javascript_include_tag  'http://api.map.baidu.com/library/MarkerClusterer/1.2/src/MarkerClusterer.js' %>
<%= javascript_include_tag "map/map_baidu" %>

<script type="text/javascript">
  $(document).ready(function() {
    MapObject.place_html = document.getElementById("place_infowindow").innerHTML;
    MapObject.share_html = document.getElementById("share_infowindow").innerHTML;
    MapObject.destination_html = document.getElementById("destination_infowindow").innerHTML;
    $('#map_infowindow').remove();
    $('#share_infowindow').remove();
    $('#place_infowindow').remove();
    $('#destination_infowindow').remove();
<% if !is_blank(@map.center_latitude,@map.center_longitude)%>
      MapObject.center = new BMap.Point('<%=@map.center_latitude%>','<%=@map.center_longitude%>')
<%end%>
<% if !is_blank(@map.zoom) %>MapObject.zoom_level = <%= @map.zoom%>;<%end%>
<%if !is_blank(@person.home_address)%>  
      MapObject.home_address = '<%=@person.home_address%>' 
<%end%>

    MapObject.initialize('<%=@person.id%>',"mapCanvas",null) ;
	
  });

</script>


<%#end%>
<div id ="temp_div" style="display: none" >
  <div id ="place_infowindow" >
    <%= render_cell :common, :new_place %>
  </div>
  <div id ="share_infowindow" >
    <%= render_cell :common, :new_share %>
  </div>
  <div id ="destination_infowindow" >
    <%= render_cell :common, :new_destination %>
  </div>   
    <div id ="see_all_infowindow" >
    <%= render_cell :common, :new_see_all %>
  </div>
</div>


<span class="button" id="pack_up">收起</span>
<span class="button" id="pack_down" style="display:none">放下</span>
<div id="mapCanvas" style="width: 100%; height: 385px;">map div</div> 
<div id="results"></div>
<div id="searchwell"></div> 
<script>
  $(document).ready(function() {
    $("#pack_down").hide();
    $("#pack_up").click(function(){
      $("#mapCanvas").slideUp("slow");
      $("#pack_up").hide();
      $("#pack_down").show()
      
    })
    $("#pack_down").click(function(){
      $("#mapCanvas").slideDown("slow");
      $("#pack_down").hide();
      $("#pack_up").show()
    })
     
  })
</script>